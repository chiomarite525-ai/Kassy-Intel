<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KASSY INTEL | NOVITA SECURE</title>
    <style>
        :root { --accent: #00ff88; --bg: #050505; --panel: #111; --border: #222; }
        body { background: var(--bg); color: #fff; font-family: -apple-system, sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 260px; border-right: 1px solid var(--border); padding: 30px; display: flex; flex-direction: column; background: #000; }
        .logo { font-size: 1.4rem; font-weight: 800; color: var(--accent); margin-bottom: 40px; letter-spacing: -1px; }
        .nav-item { padding: 12px; color: #666; cursor: pointer; font-weight: bold; margin-bottom: 10px; border-radius: 8px; transition: 0.3s; }
        .nav-item.active { color: var(--accent); background: #111; }
        .stage { flex: 1; padding: 40px; overflow-y: auto; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 700px; }
        .upload-card { width: 100%; height: 280px; background: var(--panel); border: 2px dashed #333; border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; position: relative; overflow: hidden; }
        #preview { max-height: 100%; max-width: 100%; display: none; }
        .input-wrap { margin-top: 25px; background: #111; border: 1px solid #333; border-radius: 12px; padding: 15px; }
        input[type="text"] { width: 100%; background: transparent; border: none; color: #fff; font-size: 1rem; outline: none; }
        .btn { width: 100%; padding: 18px; background: var(--accent); color: #000; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; margin-top: 20px; text-transform: uppercase; letter-spacing: 1px; }
        #status { margin-top: 20px; color: #555; font-family: monospace; text-align: center; font-size: 0.8rem; }
        video { width: 100%; border-radius: 15px; margin-top: 20px; display: none; border: 1px solid #333; box-shadow: 0 20px 50px rgba(0,255,136,0.1); }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="logo">ùïè KASSY INTEL</div>
        <div class="nav-item active">Visual Intelligence</div>
        <div style="margin-top: auto; font-size: 0.7rem; color: #222;">GOVERNMENT ENCRYPTED // 2026</div>
    </div>

    <div class="stage">
        <div class="container">
            <h1 style="margin: 0 0 10px 0;">Animate Media</h1>
            <p style="color: #666; margin-bottom: 30px;">Professional image-to-video sequence generation via Novita Node.</p>
            
            <div class="upload-card" onclick="document.getElementById('fileIn').click()">
                <div id="drop-text">üìÅ Click to Load Image Asset</div>
                <img id="preview">
                <input type="file" id="fileIn" hidden onchange="handleImg(this)">
            </div>

            <div class="input-wrap">
                <input type="text" id="motion" placeholder="Motion Description (e.g. 'Slow cinematic zoom')">
            </div>

            <button class="btn" onclick="startGen()">Generate Sequence</button>
            <div id="status">SYSTEM READY</div>
            <video id="output" controls autoplay loop></video>
        </div>
    </div>

    <script>
        // YOUR NOVITA KEY IS NOW HARDCODED BELOW
        const API_KEY = "sk_12taf6Memm65qzu_RatO9m8y_mgYYulRgv79Lhjr5LQ";
        let base64Img = "";

        function handleImg(input) {
            const reader = new FileReader();
            reader.onload = e => {
                base64Img = e.target.result.split(',')[1];
                document.getElementById('preview').src = e.target.result;
                document.getElementById('preview').style.display = 'block';
                document.getElementById('drop-text').style.display = 'none';
            };
            reader.readAsDataURL(input.files[0]);
        }

        async function startGen() {
            if(!base64Img) return alert("Please upload an image asset.");
            const status = document.getElementById('status');
            status.innerText = "INITIALIZING CLOUD UPLOAD...";

            try {
                const response = await fetch("https://api.novita.ai/v3/async/img2video", {
                    method: "POST",
                    headers: { 
                        "Authorization": `Bearer ${API_KEY}`, 
                        "Content-Type": "application/json" 
                    },
                    body: JSON.stringify({
                        model_name: "wan_v2.1_i2v",
                        image_file: base64Img,
                        frames_num: 81,
                        steps: 20,
                        prompt: document.getElementById('motion').value || "Cinematic motion"
                    })
                });
                const data = await response.json();
                if(data.task_id) pollStatus(data.task_id);
                else status.innerText = "GATEWAY ERROR: CHECK VOUCHER STATUS";
            } catch(e) { status.innerText = "CONNECTION TIMEOUT. RETRYING..."; }
        }

        async function pollStatus(id) {
            const status = document.getElementById('status');
            const check = setInterval(async () => {
                status.innerText = "RENDERING VIDEO... ESTIMATED 60S";
                const res = await fetch(`https://api.novita.ai/v3/async/task-result?task_id=${id}`, {
                    headers: { "Authorization": `Bearer ${API_KEY}` }
                });
                const d = await res.json();
                
                // Success check
                if(d.task && d.task.status === "TASK_STATUS_SUCCEED") {
                    clearInterval(check);
                    document.getElementById('output').src = d.videos[0].video_url;
                    document.getElementById('output').style.display = "block";
                    status.innerText = "DECRYPTION COMPLETE.";
                } else if (d.task && d.task.status === "TASK_STATUS_FAILED") {
                    clearInterval(check);
                    status.innerText = "RENDER FAILED: " + d.task.reason;
                }
            }, 5000);
        }
    </script>
</body>
</html>
